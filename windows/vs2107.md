Building Heimdal for Windows on VS2017
===================

1. Introduction
---------------

This document is to be read as an addition to the stabndrad README.md for windows.

Heimdal can be built on VisualStudio 2017 with a Windows 10
SDK. Versions built like this can run on Windows 7 and later.

Support for earlier versions can only be achieved using the old (nmake-based) build environment.

Whilst this document is under contstruction, a working knowledge of
how to use the the old (nmake-based) build environment is assumed.

2. Prerequisites
----------------
In addition to those mentioned in README document

* Visual Studio 2017 must be installed.  Heimdal has been built using version  15.8.7.

* A Windows 10 SDK must be installed.  Heimdal has been built using 10.0.17134.0

* ENSURE THAT THE FOLLOWING FILES HAVE UNIX LINE ENDINGS
  All .txt files in lib\wind\

3. Setting up the build environment
-----------------------------------

* The path to the cygwin binaries should be on PATH

* If code signing is to be used the following may be set

    CODESIGN_DESC - the description passed to the /d qualifier for
    codesign.  If CODESIGN_DESC is not specified no code signing is
    performed.
    
    CODESIGN_URL - the URL passed to the /u qualifier for codesign.
    If CODESIGN_URL is not specified no code signing is performed.

    CODESIGN_TIMESTAMP_SHA256 - if specified this is passed to the /t
    (timestamp) qualifier for sha256 signatures.

    CODESIGN_TIMESTAMP_SHA1 - if specified this is passed to the /t
    (timestamp) qualifier for sha1 signatures.

    CODESIGN_OTHER - is passed to the codesign command untouched.
    
    SIGNTOOL_DEFAULT - defined the tool to sign with.  If not specified a default of 'signtool.exe' is used.

* If a symbol store is to be supported the following may be set.


    SYMSTORE_DEFAULT - the tool to do symstore manipulation with. If
    not specified a default of
    "c:\Program Files (x86)\Windows Kits\10\Debuggers\x64\symstore.exe"
    is used.

`   SYMSTORE_ROOT - the root of the symstore.

* Configuraton files.  The root of the VS2017 build are three configuration files.

    Versions.props - this is the equivalent of NTMakefile.version.  It is expected to be
    edited for each release build and be part of the tag.

    Config.props - this is the equivalent of NTMakefile.config.

    Global.props - This is the euqivalent of NTMakefile.w32 and it
    unlikely to require editing.


4. Running the build
--------------------
Use Visual Studio. msbuild will be supported, instructions to follow


  